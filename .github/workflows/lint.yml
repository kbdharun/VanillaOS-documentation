name: Lint

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
    types: [opened, synchronize, reopened]

jobs:
  lint:
    runs-on: ubuntu-latest
    container:
        image: ghcr.io/vanilla-os/pico:main
    steps:
       - uses: actions/checkout@v4
       - uses: actions/setup-node@v4
         with:
           node-version: '20'
       - run: |
            npm install -g markdownlint-cli
            markdownlint $(find . -name '*.md' | grep -vF './.git') > lint-result.txt
            if [ $? -ne 0 ]; then exit 1; fi

  codespell:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/vanilla-os/pico:main
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - uses: codespell-project/actions-codespell@v2
        with:
          path: |
             articles/en
          only_warn: 1
